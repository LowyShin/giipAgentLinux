# Auto-Discover ë¡œê¹… ê°•í™” (ì˜µì…˜ B)

**ì‘ì„±ì¼**: 2025-11-25  
**ëª©ì **: auto-discoverê°€ ì‹¤í–‰ë˜ì§€ ì•ŠëŠ” ì›ì¸ ëª…í™•íˆ íŒŒì•…  
**ìƒíƒœ**: âœ… ë¡œê¹… ê°•í™” ì™„ë£Œ + DEBUG ë¡œê¹… ì¶”ê°€ (2025-11-25)

---

## ğŸ“Œ ìµœì‹  ì—…ë°ì´íŠ¸ (2025-11-25)

### ë¬¸ì œ ë°œê²¬
- âœ… auto-discover ì½”ë“œëŠ” giipAgent3.shì— ìˆìŒ (ë¼ì¸ 272-340+)
- âŒ KVSì— auto_discover_init ë¡œê·¸ê°€ ì—†ìŒ
- â¡ï¸ **ì›ì¸ ë¶ˆëª…**: ì„¹ì…˜ì´ ë„ë‹¬í•˜ëŠ”ì§€, kvs_putì´ ì„±ê³µí•˜ëŠ”ì§€ í™•ì¸ í•„ìš”

### í•´ê²°ì±…: DEBUG ë¡œê¹… ì¶”ê°€
```bash
# giipAgent3.sh ë¼ì¸ 274
echo "[giipAgent3.sh] ğŸ”µ DEBUG: About to enter auto-discover phase" >&2

# giipAgent3.sh ë¼ì¸ 285-287
echo "[giipAgent3.sh] ğŸ“ DEBUG: About to call kvs_put for auto_discover_init" >&2
kvs_put "lssn" "${lssn}" "auto_discover_init" {...}
kvs_put_result=$?
echo "[giipAgent3.sh] ğŸ“ DEBUG: kvs_put returned: $kvs_put_result" >&2
```

### ë‹¤ìŒ ë‹¨ê³„
ì„œë²„ cron ì‹¤í–‰ í›„ `check-latest.ps1` ì‹¤í–‰:
```powershell
pwsh .\mgmt\check-latest.ps1 -Lssn 71240
```
ìœ„ DEBUG ë©”ì‹œì§€ê°€ ë‚˜íƒ€ë‚˜ë©´ ì„¹ì…˜ì´ ë„ë‹¬í•˜ê³  ìˆìŒ

---

## ğŸ”— **ë¬¸ì„œ ê°„ ë§í¬**

| ë¬¸ì„œ | ê´€ê³„ | ë§í¬ |
|------|------|------|
| **[AUTO_DISCOVER_LOGGING_DIAGNOSIS.md](AUTO_DISCOVER_LOGGING_DIAGNOSIS.md)** | ì§„ë‹¨ ë°©ë²• ë¬¸ì„œ | ì›ì¸ ë¶„ì„ ë° 3ê°€ì§€ ì˜µì…˜ ì œì‹œ |
| **[GATEWAY_HANG_DIAGNOSIS.md](GATEWAY_HANG_DIAGNOSIS.md)** | ìµœìƒìœ„ ì§„ì…ì  | í•„ìˆ˜ ì½ê¸° ë¬¸ì„œ ëª©ë¡ |
| **[GATEWAY_KVS_MONITORING.md](GATEWAY_KVS_MONITORING.md)** | KVS ëª¨ë‹ˆí„°ë§ | ë¡œê¹… ê²°ê³¼ í™•ì¸ ë„êµ¬ |
| **[KVS_STORAGE_STANDARD.md](KVS_STORAGE_STANDARD.md)** | ğŸŒŸ KVS ì €ì¥ í‘œì¤€ | kvs_put() í•¨ìˆ˜ ë° ì‚¬ìš© ê·œì¹™ |
| **[giipAgent3.sh](../../giipAgentLinux/giipAgent3.sh)** | ì‹¤ì œ ì½”ë“œ | ë¡œê¹… êµ¬í˜„ ìœ„ì¹˜ (ë¼ì¸ ~250-330) |
| **[auto-discover-linux.sh](../../giipAgentLinux/giipscripts/auto-discover-linux.sh)** | ì‹¤ì œ ì½”ë“œ | ë¡œê¹… êµ¬í˜„ ìœ„ì¹˜ (ë¼ì¸ ~1-30, ~280-320) |

---

## ğŸ”„ ì‹¤í–‰ íë¦„ë„ (ë¡œê¹… ìœ„ì¹˜ ëª…ì‹œ)```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1ï¸âƒ£ giipAgent3.sh ì‹œì‘                                               â”‚
â”‚    â””â”€ echo "[giipAgent3.sh] ğŸŸ¢ [5.1] Agent ì‹œì‘"                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2ï¸âƒ£ ì„¤ì • ë¡œë“œ (common.sh, kvs.sh)                                     â”‚
â”‚    â””â”€ echo "[giipAgent3.sh] ğŸŸ¢ [5.2] ì„¤ì • ë¡œë“œ ì™„ë£Œ"                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3ï¸âƒ£ Gateway ëª¨ë“œ íŒë‹¨ (DBì—ì„œ is_gateway í™•ì¸)                       â”‚
â”‚    â”œâ”€ API í˜¸ì¶œ: LSvrGetConfig                                      â”‚
â”‚    â”œâ”€ kvs_put "api_lsvrgetconfig_response"  â†[ë¡œê¹…]                â”‚
â”‚    â””â”€ echo "[giipAgent3.sh] ğŸŸ¢ [5.3] Gateway ëª¨ë“œ ê°ì§€"             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                         â”Œâ”€ YES â”€â”
                         â†“       â†“ NO
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  NORMAL ëª¨ë“œ
                 â”‚ GATEWAY  â”‚  (ë¡œê¹… ì—†ìŒ)
                 â”‚  ëª¨ë“œ    â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
        â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
        â•‘      [5.2] AUTO-DISCOVER ë‹¨ê³„        â•‘
        â•‘     (ìƒˆë¡œ ì¶”ê°€ëœ ë¡œê¹… í¬ì¸íŠ¸)         â•‘
        â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4ï¸âƒ£ auto-discover-linux.sh ìŠ¤í¬ë¦½íŠ¸ í™•ì¸                             â”‚
â”‚    â”œâ”€ íŒŒì¼ ì¡´ì¬ ì—¬ë¶€ í™•ì¸                                           â”‚
â”‚    â”œâ”€ echo "[giipAgent3.sh] ğŸŸ¢ [5.2] Starting auto-discover..."    â”‚
â”‚    â”œâ”€ kvs_put "auto_discover_init" {"status":"starting"} â†[ë¡œê¹… #2]â”‚
â”‚    â””â”€ echo "[giipAgent3.sh] âœ… [5.2.1] auto-discover-linux.sh found"â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5ï¸âƒ£ auto-discover-linux.sh ì‹¤í–‰                                      â”‚
â”‚                                                                      â”‚
â”‚    bash auto-discover-linux.sh $LSSN $HOSTNAME $OS                 â”‚
â”‚                                                                      â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚    â”‚ auto-discover-linux.sh ë‚´ë¶€ ì‹¤í–‰                           â”‚   â”‚
â”‚    â”‚                                                            â”‚   â”‚
â”‚    â”‚ echo "[auto-discover] ğŸŸ¢ START"              â†[ë¡œê¹… ì‹œì‘] â”‚   â”‚
â”‚    â”‚ echo "[auto-discover] ğŸ“‹ Parameters: ..."                â”‚   â”‚
â”‚    â”‚                                                            â”‚   â”‚
â”‚    â”‚ â”€â”€ Step 1: OS ì •ë³´ ìˆ˜ì§‘ â”€â”€                                 â”‚   â”‚
â”‚    â”‚ echo "[auto-discover] ğŸ“‹ [Step 1] Collecting OS..."       â”‚   â”‚
â”‚    â”‚ echo "[auto-discover] âœ… [Step 1] OS: ..."                â”‚   â”‚
â”‚    â”‚                                                            â”‚   â”‚
â”‚    â”‚ â”€â”€ Step 2: CPU ì •ë³´ ìˆ˜ì§‘ â”€â”€                                â”‚   â”‚
â”‚    â”‚ echo "[auto-discover] ğŸ“‹ [Step 2] Collecting CPU..."      â”‚   â”‚
â”‚    â”‚ echo "[auto-discover] âœ… [Step 2] CPU: ..."               â”‚   â”‚
â”‚    â”‚                                                            â”‚   â”‚
â”‚    â”‚ â”€â”€ Step 3: ë©”ëª¨ë¦¬ ì •ë³´ ìˆ˜ì§‘ â”€â”€                             â”‚   â”‚
â”‚    â”‚ echo "[auto-discover] ğŸ“‹ [Step 3] Collecting Memory..."   â”‚   â”‚
â”‚    â”‚ echo "[auto-discover] âœ… [Step 3] Memory: ..."            â”‚   â”‚
â”‚    â”‚                                                            â”‚   â”‚
â”‚    â”‚ â”€â”€ Step 4: Hostname ìˆ˜ì§‘ â”€â”€                               â”‚   â”‚
â”‚    â”‚ echo "[auto-discover] ğŸ“‹ [Step 4] Collecting Hostname..." â”‚   â”‚
â”‚    â”‚ echo "[auto-discover] âœ… [Step 4] Hostname: ..."          â”‚   â”‚
â”‚    â”‚                                                            â”‚   â”‚
â”‚    â”‚ â”€â”€ Step 5: Network ìˆ˜ì§‘ â”€â”€                                â”‚   â”‚
â”‚    â”‚ echo "[auto-discover] ğŸ“‹ [Step 5] Collecting Network..."  â”‚   â”‚
â”‚    â”‚                                                            â”‚   â”‚
â”‚    â”‚ â”€â”€ JSON ìƒì„± â”€â”€                                            â”‚   â”‚
â”‚    â”‚ echo "[auto-discover] ğŸ“‹ [Step Final] Generating JSON..."  â”‚   â”‚
â”‚    â”‚ echo "[auto-discover] ğŸ“Š [Statistics] ..."                â”‚   â”‚
â”‚    â”‚ echo "[auto-discover] ğŸŒ [Network] ..."                   â”‚   â”‚
â”‚    â”‚ echo "[auto-discover] ğŸ“¦ [Inventory] ..."                 â”‚   â”‚
â”‚    â”‚ echo "[auto-discover] âœ… COMPLETED at ..."  â†[ë¡œê¹… ì¢…ë£Œ]   â”‚   â”‚
â”‚    â”‚ echo "[auto-discover] ğŸ•’ Total execution time: ..."       â”‚   â”‚
â”‚    â”‚                                                            â”‚   â”‚
â”‚    â”‚ cat <<EOF                                                 â”‚   â”‚
â”‚    â”‚ { JSON ê²°ê³¼ ì¶œë ¥ }                                         â”‚   â”‚
â”‚    â”‚ EOF                                                        â”‚   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â†“ ì„±ê³µ                â†“ ì‹¤íŒ¨/Timeout         
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ê²°ê³¼ íŒŒì¼ ì €ì¥    â”‚  â”‚ ì—ëŸ¬ ë¡œê·¸ ìº¡ì²˜          â”‚
â”‚ [5.2.6]         â”‚  â”‚ [5.2.5]                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“                       â†“
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6ï¸âƒ£ giipAgent3.shì—ì„œ ê²°ê³¼ ì²˜ë¦¬                                      â”‚
â”‚                                                                      â”‚
â”‚    if [ -s "$auto_discover_result_file" ]; then                    â”‚
â”‚      echo "[giipAgent3.sh] ğŸ’¾ [5.2.7] result saved to KVS"         â”‚
â”‚      kvs_put "auto_discover_full_result" $JSON  â†[ë¡œê¹… #6]         â”‚
â”‚      echo "[giipAgent3.sh] ğŸ“ [5.2.8] full result saved"           â”‚
â”‚    else                                                             â”‚
â”‚      echo "[giipAgent3.sh] âš ï¸ [5.2.7] Result file is empty"        â”‚
â”‚      kvs_put "auto_discover_result" {"status":"empty_result"}      â”‚
â”‚    fi                                                               â”‚
â”‚                                                                      â”‚
â”‚    ë˜ëŠ” (ì‹¤íŒ¨)                                                       â”‚
â”‚                                                                      â”‚
â”‚    if [ exit_code -eq 124 ]; then                                  â”‚
â”‚      echo "[giipAgent3.sh] âŒ [5.2.4] TIMEOUT (after 60s)"         â”‚
â”‚      kvs_put "auto_discover_result" {"status":"timeout"} â†[ë¡œê¹…]   â”‚
â”‚    else                                                             â”‚
â”‚      echo "[giipAgent3.sh] âŒ [5.2.4] failed with exit_code: ..."  â”‚
â”‚      kvs_put "auto_discover_error_log" {...}  â†[ë¡œê¹… #7]          â”‚
â”‚    fi                                                               â”‚
â”‚                                                                      â”‚
â”‚    rm -f "$auto_discover_result_file"                               â”‚
â”‚    echo "[giipAgent3.sh] ğŸ§¹ [5.2.9] Temporary files cleaned up"    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7ï¸âƒ£ auto-discover ë‹¨ê³„ ì™„ë£Œ                                          â”‚
â”‚    â””â”€ kvs_put "auto_discover_complete" {"status":"complete"}       â”‚
â”‚    â””â”€ echo "[giipAgent3.sh] ğŸŸ¢ [5.2.end] Auto-discover phase done" â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 8ï¸âƒ£ Gateway ì²˜ë¦¬ ì‹œì‘ (process_gateway_servers)                     â”‚
â”‚    â””â”€ echo "[giipAgent3.sh] ğŸ”µ About to call gateway..."           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ ë¡œê¹… í¬ì¸íŠ¸ ìš”ì•½ (ì‹¤í–‰ ìˆœì„œ)

| # | ë¡œê¹… ìœ„ì¹˜ | ë¡œê·¸ | KVS ì €ì¥ | ì„¤ëª… |
|---|---------|------|--------|------|
| 1 | giipAgent3.sh ì‹œì‘ | `ğŸŸ¢ [5.1] Agent ì‹œì‘` | - | Agent ì‹œì‘ ì•Œë¦¼ |
| 2 | ì„¤ì • ë¡œë“œ í›„ | `ğŸŸ¢ [5.2] ì„¤ì • ë¡œë“œ ì™„ë£Œ` | - | ì„¤ì • ë¡œë“œ í™•ì¸ |
| 3 | Gateway ëª¨ë“œ í™•ì¸ | `ğŸŸ¢ [5.3] Gateway ëª¨ë“œ ê°ì§€` | `api_lsvrgetconfig_response` | DBì—ì„œ Gateway ëª¨ë“œ í™•ì¸ |
| **â†’ auto-discover ë‹¨ê³„ ì‹œì‘** ||||
| 4 | auto-discover ì‹œì‘ | `ğŸŸ¢ [5.2] Starting auto-discover` | `auto_discover_init` (starting) | ìŠ¤í¬ë¦½íŠ¸ ë°œê²¬ ë° ì‹¤í–‰ ì¤€ë¹„ |
| 5 | auto-discover ì‹¤í–‰ í™˜ê²½ | `ğŸ“‹ [5.2.2] Environment: ...` | - | LSSN, Hostname, OS, PID ì •ë³´ |
| 6 | auto-discover ì‹¤í–‰ ì‹œì‘ ì‹œê°„ | `â±ï¸ [5.2.3] Execution started at:` | - | ì‹œì‘ ì‹œê°„ ê¸°ë¡ |
| **â†’ auto-discover-linux.sh ë‚´ë¶€** ||||
| 7 | auto-discover ìŠ¤í¬ë¦½íŠ¸ ì‹œì‘ | `ğŸŸ¢ START` | - | stderrë¡œ ì¶œë ¥ (giipAgent3.shì—ì„œ ìº¡ì²˜) |
| 8 | auto-discover íŒŒë¼ë¯¸í„° | `ğŸ“‹ Parameters: LSSN=...` | - | ìˆ˜ì‹ í•œ íŒŒë¼ë¯¸í„° ë¡œê¹… |
| 9 | Step 1: OS ìˆ˜ì§‘ | `ğŸ“‹ [Step 1] Collecting OS...` â†’ `âœ… [Step 1] OS: ...` | - | ê° ë‹¨ê³„ ì§„í–‰ ìƒí™© |
| 10 | Step 2: CPU ìˆ˜ì§‘ | `ğŸ“‹ [Step 2]` â†’ `âœ… [Step 2]` | - | ë™ì¼ íŒ¨í„´ |
| 11 | Step 3: Memory ìˆ˜ì§‘ | `ğŸ“‹ [Step 3]` â†’ `âœ… [Step 3]` | - | ë™ì¼ íŒ¨í„´ |
| 12 | Step 4: Hostname ìˆ˜ì§‘ | `ğŸ“‹ [Step 4]` â†’ `âœ… [Step 4]` | - | ë™ì¼ íŒ¨í„´ |
| 13 | Step 5: Network ìˆ˜ì§‘ | `ğŸ“‹ [Step 5]` | - | ìˆ˜ì§‘ ì‹œì‘ ì•Œë¦¼ |
| 14 | JSON ìƒì„± ë‹¨ê³„ | `ğŸ“‹ [Step Final] Generating JSON...` | - | JSON ìƒì„± ì‹œì‘ |
| 15 | ìˆ˜ì§‘ í†µê³„ | `ğŸ“Š [Statistics]` | - | ìˆ˜ì§‘ ê²°ê³¼ ìš”ì•½ |
| 16 | ë„¤íŠ¸ì›Œí¬ ì •ë³´ | `ğŸŒ [Network]` | - | IP ì£¼ì†Œ ì •ë³´ |
| 17 | ì¸ë²¤í† ë¦¬ ìˆ˜ | `ğŸ“¦ [Inventory]` | - | ìˆ˜ì§‘ëœ í•­ëª© ìˆ˜ |
| 18 | auto-discover ì™„ë£Œ | `âœ… COMPLETED at ...` | - | ìŠ¤í¬ë¦½íŠ¸ ì™„ë£Œ |
| 19 | ì‹¤í–‰ ì‹œê°„ | `ğŸ•’ Total execution time: ...` | - | ì „ì²´ ì†Œìš” ì‹œê°„ |
| **â†’ giipAgent3.shì—ì„œ ê²°ê³¼ ì²˜ë¦¬** ||||
| 20 | auto-discover ì™„ë£Œ ì‹œê°„ | `ğŸ•’ [5.2.5] Execution ended at:` | - | ì¢…ë£Œ ì‹œê°„ ê¸°ë¡ |
| 21 | ê²°ê³¼ íŒŒì¼ í¬ê¸° | `ğŸ“Š [5.2.6] Result file size:` | - | ìƒì„±ëœ JSON í¬ê¸° |
| 22 | ê²°ê³¼ ì €ì¥ (ì„±ê³µ) | `ğŸ’¾ [5.2.7] result saved to KVS` | `auto_discover_result` (success) | ê²°ê³¼ ì €ì¥ ì™„ë£Œ |
| 23 | ì „ì²´ ê²°ê³¼ ì €ì¥ | `ğŸ“ [5.2.8] full result saved` | `auto_discover_full_result` | ì „ì²´ JSON ì €ì¥ |
| 24 | ì„ì‹œ íŒŒì¼ ì •ë¦¬ | `ğŸ§¹ [5.2.9] Temporary files cleaned` | - | ì„ì‹œ íŒŒì¼ ì‚­ì œ |
| 25 | auto-discover ë‹¨ê³„ ì¢…ë£Œ | `ğŸŸ¢ [5.2.end] Auto-discover phase done` | `auto_discover_complete` | ë‹¨ê³„ ì™„ë£Œ ì•Œë¦¼ |
| **â†’ Gateway ì²˜ë¦¬ë¡œ ì§„í–‰** ||||
| 26 | Gateway ì‹œì‘ | `ğŸ”µ About to call gateway...` | - | Gateway ì²˜ë¦¬ ì‹œì‘ |

---

## ğŸ”´ ë¬¸ì œ ì‹œ í™•ì¸ í¬ì¸íŠ¸

### âŒ auto-discover í˜¸ì¶œ ì•ˆ ë¨
- **ë¼ì¸ 4-5** ë¡œê·¸ ì—†ìŒ â†’ `auto_discover_init` KVS ì—†ìŒ
- **í•´ê²°**: giipAgent.cnfì—ì„œ `is_gateway=1` í™•ì¸

### â±ï¸ auto-discover Timeout
- **ë¼ì¸ 20** ì‹œê°„ì´ ë‚˜ì˜¤ì§€ ì•ŠìŒ (60ì´ˆ ì´ìƒ ëŒ€ê¸°)
- **KVS**: `auto_discover_result` = "timeout"
- **í•´ê²°**: íŠ¹ì • Stepì—ì„œ ë¬¸ì œ ë°œìƒ (Step 1-5 ë¡œê·¸ í™•ì¸)

### âŒ auto-discover ì‹¤í–‰ ì‹¤íŒ¨
- **ë¼ì¸ 18-19** ë¡œê·¸ ì—†ìŒ
- **ë¼ì¸ 24** `auto_discover_error_log` KVS í™•ì¸
- **í•´ê²°**: ì—ëŸ¬ ë¡œê·¸ì˜ Step ë²ˆí˜¸ í™•ì¸

---

## ğŸ“Š ì‹¤ì‹œê°„ ì§„ë‹¨ (5ë¶„ë§ˆë‹¤ í™•ì¸)

```powershell
# auto-discover ì´ˆê¸°í™”
pwsh .\mgmt\query-kvs.ps1 -KType lssn -KKey 71174 -KFactor "auto_discover_init" -Hours 0.1

# auto-discover ê²°ê³¼
pwsh .\mgmt\query-kvs.ps1 -KType lssn -KKey 71174 -KFactor "auto_discover_result" -Hours 0.1

# auto-discover ì „ì²´ ê²°ê³¼
pwsh .\mgmt\query-kvs.ps1 -KType lssn -KKey 71174 -KFactor "auto_discover_full_result" -Hours 0.1

# auto-discover ì—ëŸ¬
pwsh .\mgmt\query-kvs.ps1 -KType lssn -KKey 71174 -KFactor "auto_discover_error_log" -Hours 0.1

# auto-discover ì™„ë£Œ
pwsh .\mgmt\query-kvs.ps1 -KType lssn -KKey 71174 -KFactor "auto_discover_complete" -Hours 0.1
```
ğŸ“‹ Step 1      - OS ì •ë³´ ìˆ˜ì§‘ ì¤‘
âœ… Step 1      - OS ì •ë³´ ìˆ˜ì§‘ ì™„ë£Œ
ğŸ“‹ Step 2      - CPU ì •ë³´ ìˆ˜ì§‘ ì¤‘
âœ… Step 2      - CPU ì •ë³´ ìˆ˜ì§‘ ì™„ë£Œ
ğŸ“‹ Step 3      - ë©”ëª¨ë¦¬ ì •ë³´ ìˆ˜ì§‘ ì¤‘
âœ… Step 3      - ë©”ëª¨ë¦¬ ì •ë³´ ìˆ˜ì§‘ ì™„ë£Œ
ğŸ“‹ Step 4      - Hostname ìˆ˜ì§‘ ì¤‘
âœ… Step 4      - Hostname ìˆ˜ì§‘ ì™„ë£Œ
ğŸ“‹ Step 5      - ë„¤íŠ¸ì›Œí¬ ìˆ˜ì§‘ ì¤‘
ğŸ“‹ Step Final  - JSON ìƒì„± ì¤‘
ğŸ“Š Statistics  - ìˆ˜ì§‘ í†µê³„ (OS, CPU, Memory)
ğŸŒ Network     - IP ì£¼ì†Œ ì •ë³´
ğŸ“¦ Inventory   - ì¸ë²¤í† ë¦¬ ìˆ˜ (Network, Software, Services)
âœ… COMPLETED   - ìŠ¤í¬ë¦½íŠ¸ ì™„ë£Œ (PID, ì‹œê°„)
ğŸ•’ Total execution time - ì „ì²´ ì‹¤í–‰ ì‹œê°„
```

---

## ğŸ” ì§„ë‹¨ ë°©ë²•

### Step 1: KVSì—ì„œ auto-discover ê´€ë ¨ ë¡œê·¸ ì¡°íšŒ

```powershell
# giipdb ë””ë ‰í† ë¦¬ì—ì„œ ì‹¤í–‰

# 1ï¸âƒ£ auto-discover ì´ˆê¸°í™” ë¡œê·¸
pwsh .\mgmt\query-kvs.ps1 -KType lssn -KKey 71174 -KFactor "auto_discover_init" -Hours 1

# 2ï¸âƒ£ auto-discover ê²°ê³¼ ë¡œê·¸
pwsh .\mgmt\query-kvs.ps1 -KType lssn -KKey 71174 -KFactor "auto_discover_result" -Hours 1

# 3ï¸âƒ£ auto-discover ì „ì²´ ê²°ê³¼ (JSON)
pwsh .\mgmt\query-kvs.ps1 -KType lssn -KKey 71174 -KFactor "auto_discover_full_result" -Hours 1

# 4ï¸âƒ£ auto-discover ì—ëŸ¬ ë¡œê·¸
pwsh .\mgmt\query-kvs.ps1 -KType lssn -KKey 71174 -KFactor "auto_discover_error_log" -Hours 1

# 5ï¸âƒ£ auto-discover ì™„ë£Œ ì•Œë¦¼
pwsh .\mgmt\query-kvs.ps1 -KType lssn -KKey 71174 -KFactor "auto_discover_complete" -Hours 1

# 6ï¸âƒ£ ëª¨ë“  auto-discover ê´€ë ¨ ë¡œê·¸ ìš”ì•½
pwsh .\mgmt\query-kvs.ps1 -KType lssn -KKey 71174 -Hours 0.5 -Summary | grep -i auto
```

### Step 2: ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ (cron ì‹¤í–‰ í›„)

cronì—ì„œ ì‹¤í–‰ë˜ëŠ” giipAgent3.shì˜ stderrë¥¼ í™•ì¸:

```bash
# ì„œë²„ì—ì„œ:
# giipAgent3.shê°€ ë‹¤ìŒ cycleì—ì„œ ì‹¤í–‰ë  ë•Œê¹Œì§€ ëŒ€ê¸° í›„

# ìµœê·¼ ì‹¤í–‰ ë¡œê·¸ í™•ì¸ (cronì´ ìë™ ê¸°ë¡)
grep giipAgent /var/log/syslog | tail -50

# ë˜ëŠ” ì§ì ‘ stderr ìº¡ì²˜ (ìˆ˜ë™ ì‹¤í–‰)
cd /opt/giip/agent/linux
bash giipAgent3.sh 2>&1 | grep -E "auto-discover|auto_discover|\[5\.2\]"
```

### Step 3: Discovery ë¡œê·¸ì™€ ë¹„êµ

ì´ì „ì— í™•ì¸í•œ `discovery_collection_local` ë¡œê·¸ì™€ í•¨ê»˜ ë¹„êµ:

```powershell
# discovery_collection_local ìƒíƒœ í™•ì¸
pwsh .\mgmt\query-kvs-discovery-logs.ps1 -Hours 1 -Summary

# auto-discover ìƒíƒœ í™•ì¸
pwsh .\mgmt\query-kvs.ps1 -KType lssn -KKey 71174 -KFactor "auto_discover_result" -Hours 1

# ë¹„êµ:
# - auto_discover_resultê°€ ì—†ìŒ â†’ auto-discover ì‹¤í–‰ ì•ˆ ë¨
# - auto_discover_result = "TIMEOUT" â†’ 60ì´ˆ ì´ˆê³¼
# - auto_discover_result = "FAILED" â†’ ì‹¤íŒ¨ (exit code í™•ì¸)
# - discovery_collection_localê³¼ ì‹œê°„ ë¹„êµ
```

---

## ğŸ“Š ê°€ëŠ¥í•œ ì§„ë‹¨ ê²°ê³¼

### ì‹œë‚˜ë¦¬ì˜¤ 1: auto-discover í˜¸ì¶œ ì•ˆ ë¨
**ì¦ìƒ**:
- `auto_discover_init` ë¡œê·¸ ì—†ìŒ
- `auto_discover_result` ë¡œê·¸ ì—†ìŒ

**ì›ì¸**:
- giipAgent3.shê°€ GATEWAY ëª¨ë“œê°€ ì•„ë‹˜
- auto-discover-linux.sh íŒŒì¼ ì—†ìŒ
- ìŠ¤í¬ë¦½íŠ¸ ê²½ë¡œ ì˜¤ë¥˜

**í•´ê²°**:
- giipAgent.cnf í™•ì¸: `is_gateway=1` ì„¤ì • ì—¬ë¶€
- `giipscripts/auto-discover-linux.sh` íŒŒì¼ ì¡´ì¬ í™•ì¸

---

### ì‹œë‚˜ë¦¬ì˜¤ 2: auto-discover ì‹¤í–‰ë¨ (ì„±ê³µ)
**ì¦ìƒ**:
- `auto_discover_init` = "starting"
- `auto_discover_result` = "success"
- `auto_discover_full_result` = JSON ë°ì´í„°

**í•´ì„**: âœ… **ì •ìƒ ì‘ë™ ì¤‘**

---

### ì‹œë‚˜ë¦¬ì˜¤ 3: auto-discover Timeout
**ì¦ìƒ**:
- `auto_discover_result` = "timeout"
- `timeout_seconds: 60`

**ì›ì¸**:
- ì‹œìŠ¤í…œ ì •ë³´ ìˆ˜ì§‘ ì¤‘ hang
- ë„¤íŠ¸ì›Œí¬ ë¬¸ì œë¡œ ì¸í•œ ì§€ì—°
- ë””ìŠ¤í¬ ëŠë¦¼

**í•´ê²°**:
- timeout ê°’ ì¦ê°€ (giipAgent3.sh ë¼ì¸: `timeout_seconds=60`)
- ë˜ëŠ” íŠ¹ì • ìˆ˜ì§‘ í•­ëª© ë¹„í™œì„±í™” (auto-discover-linux.sh ìˆ˜ì •)

---

### ì‹œë‚˜ë¦¬ì˜¤ 4: auto-discover ì‹¤íŒ¨ (Exit Code)
**ì¦ìƒ**:
- `auto_discover_result` = "failed"
- `exit_code: [ìˆ«ì]`
- `auto_discover_error_log` ìˆìŒ

**ì›ì¸**: ì—ëŸ¬ ë¡œê·¸ ë¯¸ë¦¬ë³´ê¸° ì°¸ê³ 

**í•´ê²°**: ì—ëŸ¬ ë¡œê·¸ì— ë”°ë¼ ëŒ€ì‘

---

## ğŸ”§ í•„ìš”ì‹œ Timeout ì¡°ì •

auto-discoverê°€ timeoutë˜ë©´ ê°’ì„ ëŠ˜ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

**giipAgent3.sh ë¼ì¸ 251 ìˆ˜ì •**:
```bash
# í˜„ì¬
timeout_seconds=60

# ë³€ê²½ ì˜ˆì‹œ (120ì´ˆë¡œ ì¦ê°€)
timeout_seconds=120
```

---

## ğŸ“Œ ë‹¤ìŒ í™•ì¸ ë‹¨ê³„

1. **ìµœê·¼ 5ë¶„ê°„ ìë™ ì‹¤í–‰ ëŒ€ê¸°** (cronì´ 5ë¶„ ì£¼ê¸°)
2. **KVS ë¡œê·¸ í™•ì¸** (ìœ„ì˜ ì¿¼ë¦¬ ì‹¤í–‰)
3. **ì‹œë‚˜ë¦¬ì˜¤ë³„ ê²°ê³¼ í•´ì„**
4. **ë¬¸ì œ ë°œê²¬ ì‹œ ë¬¸ì„œ ê³µìœ ** (ë¶„ì„ ê²°ê³¼ì™€ í•¨ê»˜)

---

## ğŸ’¾ ì €ì¥ëœ ì½”ë“œ ë³€ê²½ì‚¬í•­

### íŒŒì¼ 1: giipAgent3.sh
**ë¼ì¸**: ~250-320 (ìƒˆë¡œ ì¶”ê°€ëœ [5.2] auto-discover ì„¹ì…˜)
**ë‚´ìš©**: 
- auto-discover ìŠ¤í¬ë¦½íŠ¸ ê²½ë¡œ í™•ì¸
- 60ì´ˆ timeout ì ìš©
- 9ê°œ ë¡œê¹… í¬ì¸íŠ¸
- KVS ì €ì¥ (5ê°œ í•­ëª©)

### íŒŒì¼ 2: auto-discover-linux.sh
**ë¼ì¸**: ~1-20 (ì‹œì‘ ë¶€ë¶„), ~280-320 (ë ë¶€ë¶„)
**ë‚´ìš©**:
- ìŠ¤í¬ë¦½íŠ¸ ì‹œì‘/ì¢…ë£Œ ë¡œê¹…
- ê° ìˆ˜ì§‘ ë‹¨ê³„ ë¡œê¹… (Step 1-5, Final)
- í†µê³„ ì •ë³´ ë¡œê¹…

---

## ğŸ¯ ê¸°ëŒ€ íš¨ê³¼

ì´ì œ ë‹¤ìŒì„ ì •í™•íˆ íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

| í™•ì¸ í•­ëª© | ë¡œê·¸ | ë¹„ê³  |
|----------|------|------|
| auto-discover í˜¸ì¶œ ì—¬ë¶€ | `auto_discover_init` | ì—†ìœ¼ë©´ í˜¸ì¶œ ì•ˆ ë¨ |
| ì‹¤í–‰ ì™„ë£Œ ì—¬ë¶€ | `auto_discover_result` | SUCCESS/FAILED/TIMEOUT |
| ì‹¤í–‰ ì‹œê°„ | giipAgent3.sh ë¡œê·¸ | [5.2.3] ~ [5.2.5] |
| ì–´ëŠ ë‹¨ê³„ì—ì„œ ë¬¸ì œ | auto-discover stderr | Step 1-5 | 
| íƒ€ì„ì•„ì›ƒ ì—¬ë¶€ | `auto_discover_result` | timeout_seconds í™•ì¸ |
| ì •í™•í•œ ì—ëŸ¬ | `auto_discover_error_log` | ì›ì¸ íŒŒì•… ê°€ëŠ¥ |

---

## â° ì˜ˆìƒ ì¼ì •

- **5ë¶„ í›„**: ì²« ë²ˆì§¸ ë¡œê·¸ í™•ì¸
- **10ë¶„ í›„**: íŒ¨í„´ íŒŒì•… (ì„±ê³µ/ì‹¤íŒ¨)
- **15ë¶„ í›„**: ì›ì¸ ê·œëª… ë° ëŒ€ì‘
- **ì´í›„**: ê·¼ë³¸ ì›ì¸ í•´ê²°

